<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Food Waste App</title>
    <link rel="stylesheet" href="/static/css/style.css" />
    <!-- <link href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css" rel="stylesheet"> -->
    <link
      href="https://fonts.googleapis.com/css2?family=Luckiest+Guy&display=swap"
      rel="stylesheet"
    />
    <script src="/static/js/code.js"></script>
    <script
      defer
      src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"
    ></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  </head>
  <body x-data="FoodwasteApp">
  <body>
    <!-- STYLE BETTER WITHOUT MATERIALIZE -->
    <div class="baner">
      <div class="nav-links">
        <a href="{{ url_for('user_account') }}">Home</a>
 
        <a href="{{ url_for('user_account_game') }}">Games</a>
        <a href="">Contact Us</a>
        <a href="/logout">Log Out</a>
      </div>
    </div>

    <!-- <div class="logo-container">
        <img src="./images/logo.png" alt="logo" class="logo">
    </div> -->

    <div class="welcome-banner">
      <h2>Welcome, {{user_name}}</h2>
      <p>
        Explore our educational modules below to learn more about food waste
      </p>
      <h3>GENERAL RULES TO FOLLOW FOR THE WORD GAME</h3>   
      <p>1. Words can be aligned vertically, horizontally or diagonal </p>
      <p>2. Click on the characters once you find the words displayed on the word list </p>
      <p>3. Double click to unselect a character </p>
      <p>4. Good luck </p>


    
      <div id="review-section">
          
      
          {% with messages = get_flashed_messages(with_categories=true) %}
          {% if messages %}
              {% for category, message in messages %}
                  <div class="alert alert-{{ category }}">{{ message }}</div>
              {% endfor %}
          {% endif %}
          {% endwith %}
       
      </div>
     
      <div class="words-to-find">
        <h3>Words to Find:</h3>
        <ul id="wordList">
            {% for word in words %}
                <li class="word-item" data-word="{{ word }}">{{ word }}</li>
            {% endfor %}
        </ul>
    </div>
    



    </div>

    <!--GENERAL -->
    <div class="cards-container" x-show="Admin_Home_Page" x-cloak>
   <div class="">

    <h2 class="header">PLAY A WORD GAME</h2>
    <form method="POST" action="{{ url_for('user_account_game') }}">
        <table class="word-search-grid" id="wordGrid">
            {% for row_index, row in grid %}
                <tr>
                    {% for col_index, cell in row %}
                        <td class="grid-cell" data-row="{{ row_index }}" data-col="{{ col_index }}">{{ cell }}</td>
                    {% endfor %}
                </tr>
            {% endfor %}
        </table>
        <div class="text-center mt-3">
            
        </div>
    </form>







    


   </div>
        
      

   
    </div>







    <footer class="footer">
      <div class="footer-content">
        <p>&copy; 2024 Food Waste Awareness. All Rights Reserved.</p>
      </div>
    </footer>


    <script>
        // JavaScript to hide the review section after 10 seconds (10000 milliseconds)
        document.addEventListener("DOMContentLoaded", function() {
            setTimeout(function() {
                var reviewSection = document.getElementById("review-section");
                if (reviewSection) {
                    reviewSection.style.display = "none";
                }
            }, 5000); // Change the time (in milliseconds) as needed
        });
    </script>

    <script>
        // Wait for the page to load before running the script
        document.addEventListener("DOMContentLoaded", function() {
            // Select all elements with the alert class
            const alerts = document.querySelectorAll(".alert");
    
            // Set a timeout to hide each alert after 5 seconds (5000 milliseconds)
            alerts.forEach(alert => {
                setTimeout(() => {
                    alert.style.transition = "opacity 0.5s ease"; // Smooth fade-out
                    alert.style.opacity = "0"; // Start fade-out
                    setTimeout(() => alert.remove(), 500); // Fully remove after fade-out
                }, 5000);
            });
        });
    </script>

    <script>
		document.addEventListener("DOMContentLoaded", function() {
			const alerts = document.querySelectorAll(".alert");
			alerts.forEach(alert => {
				setTimeout(() => {
					alert.style.opacity = "0";
					setTimeout(() => alert.remove(), 500);
				}, 5000);
			});
		});
	</script>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            let selectedCells = [];
            let wordGrid = document.getElementById('wordGrid');
            let wordList = {{ words | tojson }}; // Array of words to find
            let foundWords = [];
        
            wordGrid.addEventListener('click', function (event) {
                if (event.target.classList.contains('grid-cell')) {
                    event.target.classList.toggle('selected');
        
                    let cellRow = event.target.getAttribute('data-row');
                    let cellCol = event.target.getAttribute('data-col');
                    let cellLetter = event.target.innerText;
        
                    // Check if cell is already selected
                    let cellIndex = selectedCells.findIndex(
                        cell => cell.row === cellRow && cell.col === cellCol
                    );
        
                    if (cellIndex === -1) {
                        selectedCells.push({ row: cellRow, col: cellCol, letter: cellLetter });
                    } else {
                        selectedCells.splice(cellIndex, 1); // Deselect the cell
                    }
        
                    // Check if selected letters form a word
                    let formedWord = selectedCells.map(cell => cell.letter).join('');
                    if (wordList.includes(formedWord) && !foundWords.includes(formedWord)) {
                        alert('Found: ' + formedWord);
        
                        // Cross out the word in the list
                        let wordElement = document.querySelector(`.word-item[data-word="${formedWord}"]`);
                        if (wordElement) {
                            wordElement.classList.add('found');
                        }
        
                        // Highlight the found cells in the grid
                        selectedCells.forEach(cell => {
                            document.querySelector(`.grid-cell[data-row="${cell.row}"][data-col="${cell.col}"]`).classList.add('found');
                        });
        
                        foundWords.push(formedWord); // Add the found word to the list
                        selectedCells = []; // Clear selection after finding a word
        
                        // Check if all words have been found
                        if (foundWords.length === wordList.length) {
                            setTimeout(() => {
                                alert('GAME OVER');
                                window.location.href = "{{ url_for('user_account') }}"; // Redirect to homepage
                            }, 1000); // Delay to allow the user to see the message
                        }
                    }
                }
            });
        });
        
        
        
    </script>


  </body>
</html>
